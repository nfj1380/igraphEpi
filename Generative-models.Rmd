---
title: "Generative models"
author: "Raima"
date: "03/08/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(igraph)
```


```{r}
#Random graph
erdos<-function(n,p){
  erdos_graph=sample_gnp(n, p, directed = FALSE, loops = FALSE)
summary(erdos_graph)
}
f1=erdos(10,0.6)
plot(f1)
```


```{r}
#Small-world
sm_world<-function(d,s,n,p){
  sm_graph=sample_smallworld(d, s, n, p, loops = F, multiple = F)
summary(sm_graph)
}
f2=sm_world(1, 100, 5, 0.05)
plot(f2)
```


```{r}
#Lattice graph
Lattice<-function(d,l){
  lattice_graph=make_lattice(dim=d,length=l, directed= F, mutual= T, circular = F)
summary(lattice_graph)
}
f3=Lattice(2,5)
plot(f3)
```

```{r}
#scale free
scale_free<-function(n,pw){
  scale_free_graph=sample_pa(n,pw, directed= F)
summary(scale_free_graph)
}
f4=scale_free(50,1)
plot(f4)
```


```{r}
#Spatial graph of x,y coordinate join in space
spatial <- function(n,r) {
  V <- NULL
  for (i in 1:n) {
    x <- runif(1)
    y <- runif(1)
    V <- rbind(V,c(i,x,y))
    coords<<-rbind(coords, c(x,y))
  }
  E <- NULL
  R2 <- r*r;
  for (i in 1:n) {
    for (j in 1:n) {
      if (((V[i,2]-V[j,2])^2 + (V[i,3]-V[j,3])^2) < R2) {
        E <- as.data.frame(rbind(E,c(i,j)))
      }
    }
  }
  return(E)
}
coords=NULL
spatial(10,0.2)

G=graph_from_data_frame(E)%>% as.undirected( "collapse")
G=igraph::simplify(G,remove.multiple = F, remove.loops = T)

plot(G,edge.arrow.size=4,layout=coords)

```